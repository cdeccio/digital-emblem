<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<rfc category="std" docName="draft-haberman-digital-emblem-00" ipr="trust200902">
 <front>
   <title abbrev="Digital Emblems">Digital Emblems Indicating Protections Under International Law</title>

   <author fullname="Brian Haberman" initials="B." surname="Haberman" role="editor">
      <organization abbrev="JHU APL">Johns Hopkins University Applied Physics Lab</organization>
      <address>
        <email>brian@innovationslab.net</email>
      </address>
   </author>
   <author fullname="Allison Mankin" initials="A." surname="Mankin">
      <organization abbrev="PCH">Packet Clearing House</organization>
      <address>
         <email>amankin@gmail.com</email>
      </address>
   </author>
   <author fullname="Bill Woodcock" initials="B." surname="Woodcock">
      <organization abbrev="PCH">Packet Clearing House</organization>
      <address>
         <email>woody@pch.net</email>
      </address>
   </author>
   <author fullname="Casey Deccio" initials="C." surname="Deccio">
      <organization abbrev="BYU">Brigham Young University</organization>
      <address>
         <email>casey@deccio.net</email>
      </address>
   </author>
   <author fullname="Antonio DeSimone" initials="A." surname="DeSimone">
      <organization abbrev="JHU APL">Johns Hopkins University Applied Physics Lab</organization>
      <address>
         <email>antonio.desinome@jhuapl.edu</email>
      </address>
   </author>

   <abstract>
   <t>International law defines a number of emblems, such as the blue helmets of United Nations peacekeeping forces,
   the blue and white shield of UNESCO, and the Red Cross of the International Committee of the Red Cross, as indicative
   of special protections under the Geneva Conventions. Similar protections attach to journalists who wear "Press" protective
   emblems on the battlefield, under Article 79 of Protocol I of the Geneva Conventions and Resolution 2222 of the United
   Nations Security Council. The emblems of national governments and inter-governmental organizations protect diplomatic
   pouches, couriers, and envoys under the Vienna Convention on Diplomatic Relations. Other marks enjoy protections against
   mis-use under the Paris Convention, the Madrid Protocol, and the Trade-Related Aspects of Intellectual Property Rights.</t>

   <t>Such physical emblems have a number of weaknesses (e.g., no real-time evaluation of their authenticity) and do not
   translate to the digital realm. This document describes a digital emblem which addresses the shortcomings of the physical
   emblems and makes possible the indication of protections of digital assets under international law.</t>
   </abstract>
 </front>

 <middle>
   <section anchor="intro" title="Introduction">

   <t>International law defines a number of emblems, such as the blue helmets of United Nations (UN) peacekeeping forces,
   the blue and white shield of UNESCO, and the Red Cross of the International Committee of the Red Cross (ICRC), as indicative
   of special protections under international law. Similar protections attach to journalists who wear "Press" protective
   emblems on the battlefield. The emblems of national governments and inter-governmental organizations protect diplomatic
	   pouches, couriers, and envoys, and international law protects certain marks against counterfeiting.</t>

   <t>Physical emblems suffer from a number of weaknesses:
   <list style="bullets">
	   <t>It is not possible to evaluate their authenticity in real-time,</t>
	   <t>They are not amenable to machine readability,</t>
	   <t>They cannot be seen in the dark,</t>
	   <t>They may not be visible at a distance, at an oblique angle, or from the opposite side of an object,</t>
	   <t>They may be subject to wear, obfuscation, or vandalism,</t>
	   <t>No audit mechanism exists to prove that the presence of an emblem has been queried for,</t>
	   <t>No mechanism exists to prevent replay attacks,</t>
	   <t>No mechanism exists to prevent time-shifting attacks,</t>
	   <t>No mechanism exists to prevent location-shifting attacks,</t>
	   <t>No mechanism exists to correlate an emblem with a specific quantity of persons or items, or a physical extent,</t>
	   <t>No mechanism exists to correlate the validity of an emblem with its use in a specific place or time,</t>
	   <t>There is no centralized ability to revoke instances of emblems which have been compromised, are being abused, or are no longer relevant.</t>
   </list></t>

   <t>A digital emblem must meet certain criteria to perform its function of notification under law:
   <list style="bullets">
	   <t>It MUST provide a clearly detectable and unambiguous marking,</t>
	   <t>The emblem MUST identify the authorizing party that issued it,</t>
	   <t>The emblem MUST be robust against misuse,</t>
	   <t>It MUST be possible to restrict the validity of an emblem by temporal or geographic scope,</t>
	   <t>It MUST be possible to associate the emblem with a range or specific quantity of persons or items,</t>
	   <t>It MUST be possible to associate the emblem with online services (e.g., websites, emails),</t>
	   <t>It MUST be possible to associate the emblem with data in transit or at rest,</t>
	   <t>It MUST be possible to associate the emblem with network-addressable equipment (e.g., routers, servers),</t>
	   <t>It MUST be possible to associate the emblem with a physical object (e.g., building, vehicle),</t>
	   <t>It MUST be possible to associate the emblem with a person or group of people,</t>
	   <t>It SHOULD be possible to view an emblem in-band via a communications network, optically (e.g., QR code), or wirelessly (e.g., RFID),</t>
	   <t>The digital emblem MUST be capable of carrying a visual representation of the emblem,</t>
	   <t>The emblem MUST carry an unambiguous indication of the international law or laws conferring protection upon the entity marked with the emblem,</t>
	   <t>The emblem MUST be capable of providing a reference to additional relevant information (e.g., photographs, unique identifiers) which can be
		   used to corroborate the association of the digital emblem with the entity bearing it,</t>
	   <t>Querying the existence of or validating a digital emblem MUST NOT impose undue risk or cost on any party to the transaction.</t>
   </list></t>

   <t>This document describes a protocol for the creation and publication of a digital emblem utilizing the
   Domain Name System (DNS) global infrastructure.</t>

   <section title="Conventions">
   <t>The capitalized key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
   "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
   <xref target="RFC2119" />.</t>
   </section>
   </section>

   <section title="Protocol Overview">
   <t><strong>The remaining sections and text are placefolders based on the early prototype work</strong></t>
   <t> The objective of the protocol is to allow organizations to digitally signal that assets are
   entitled to protection from attack under law.
   These assets include both physical and virtual resources (servers, virtual machines, etc.) and network traffic
   associated with those resources. This is accomplished by associating a digital emblem attribute with the DNS
   domain name, or sub-domain, and/or with the IP address(es) associated with those resource(s).</t>

   <t>The following sub-sections describe the three parties associated with the digital emblem and their roles in creating an emblem.</t>

   <section title="Actors">

   <section title="Approvers">
   <t>An Approver is an organization empowered to authorize the use of the emblem. Each member of the United Nations
   has an identified organization tasked with fulfilling this role. All Approvers, or an organization operating on
   their behalf, generate and maintain digital signing
   credentials in TLSA records published in the DNS (Section <xref target="creds"/>).
   An Approver receives requests for use of the digital
   emblem from Requestors. If the request satisfies all necessary requirements, the Approver generates the necessary
   cryptographic material and returns it to the Requestor (Section <xref target="attributes"/>).</t>
   </section>

   <section title="Requestors">
   <t>A Requestor is any organization wishing to use the digital emblem to protect the digital assets associated with
   its humanitarian mission. The Requestor sends the necessary DNS resource information to an Approver. If the Approver
   approves the use of the digital emblem for the identified resources, the Requestor publishes the returned cryptographic
   material in a Digital Emblem Record (Section <xref target="DER"/>).</t>
   </section>

   <section title="Observers">
   <t>An Observer is any entity that wishes to assess the claim of protection under the digital emblem. This is accomplished
   by obtaining both the Digital Emblem Record associated with a target system (domain name or IP address) published by the Requestor
   and the signing certificate associated with the Approver that is identified in the Digital Emblem Record. An Observer then uses the key material
   in the signing certificate to verify the cryptographic material published in the target's Digital Emblem Record (Section
   <xref target="verify"/>).</t>
   </section>
   </section>
   </section>

   <section title="Digital Emblem Material in DNS">
   <section title="Approver Credentials" anchor="creds">
   <t>Approvers generate, publish, and maintain valid digital signing certificates for attesting to Digital Emblem Records.
   These signing certificates MUST be published in the DNS via DNS-based Authentication of Named Entities (DANE) TLSA Record
   <xref target="RFC6698"/>.</t>

   <t>TODO : Add text on the generation of the key material and signing certificate</t>

   <t>TODO : Add text on necessary DANE TLSA parameters for use with the Digital Emblem per <xref target="RFC7671"/></t>

   <t>All TLSA records MUST be protected by DNS Security Extensions (DNSSEC)
   <xref target="RFC4033"/><xref target="RFC4034"/><xref target="RFC4035"/>.</t>
   </section>

   <section title="Digital Emblem Record" anchor="emblem">

   <section title="Approver Generated Material" anchor="attributes">
   <t>Once an Approver has deemed a request to be satisfactory, it generates two pieces of cryptographic material. First,
   the Approver generates a pseudo-random number (i.e., nonce) using a secure random number generator (TBD: need additional
   details on the characteristics of the nonce). Second, the Approver generates a digital signature (FIPS.186-5?)
   using its private key associated with its signing certificate (published in a DNS TLSA record) over the
   nonce and the identifying material (e.g., domain name) provided by the Requestor.</t>

   <t>After generating the above material, the Approver returns the nonce, the digital signature, and a reference to its
   DNS TLSA record containing the corresponding signing certificate.</t>
   </section>

   <section title="Digital Emblem Record" anchor="DER">
   <t>A Digital Emblem Record (DER) is a DNS record that declares that a host is protected under IHL. The DER is expressed
   as a single string of text found in the RDATA of a single DNS TXT resource record. Multiple DER records MAY exist for
   the same name. This occurs if the Requestor has received authorization from multiple Approvers. Each DER is placed in the
   DNS tree at the owner name to which it pertains. Given that TXT records serve multiple purposes, publishers need to be
   mindful of size limitations.</t>

   <t>TODO : Need to consider the creation of a new DNS RR type for DER</t>

   <t>A notional DER string is as follows:</t>
   <figure>
   <artwork><![CDATA[
      de=c517d02d6554a9add49b emblem.example.org e5d391930ac48dd482810fed
   ]]></artwork>
   </figure>

   <t>The fields in the DER are as follows:
   <list style="bullets">
      <t>de - indentifies the DER string</t>
      <t>nonce - A pseudo random number generated by the Approver</t>
      <t>reference - The DNS name of the endpoint approving the use of the digital emblem</t>
      <t>signature - Digital signature generated by the Approver</t>
   </list></t>

   <t>Publication of a DER follows all the rules for publishing DNS resource records described in <xref target="RFC1035"/>.
   The DER MUST be protected by DNSSEC.</t>

   <t>TODO : Integrate underscored naming indicator per <xref target="RFC8552"/>.</t>

   <t>The publication of a DER under a domain name indicates protection for that name under IHL. Protection for IP addresses is
   accomplished through the use of the DNS reverse zone. If protection under IHL is requested for an IP address, the Requestor
   MUST:
   <list style="bullets">
      <t>Obtain a proper IP address delegation</t>
      <t>Publish a reverse zone mapping the target IP addresses to domain names</t>
      <t>Requests approval for use of the digital emblem from an Approver for the target domain names</t>
   </list></t>

   </section>
   </section>

   <section title="Digital Emblem Verification" anchor="verify">
   <t>Any entity can act as an Observer and verify the existence and validity of a digital emblem associated with a target system.
   An Observer performs the following tasks:
   <list style="numbers">
      <t>Perform a DNS lookup for a TXT record associated with the target system.</t>
      <t>If a TXT record exists, parse it for a DER. Otherwise, terminate process.</t>
      <t>If a DER exists, extract the nonce, reference, and signature. Otherwise, terminate process.</t>
      <t>Perform a DNS lookup for the TLSA record associated with the reference.</t>
      <t>If the TLSA exists, extract the key material. Otherwise, terminate process.</t>
      <t>Using the retrieved key material, nonce, and target domain name, verify the signature.</t>
   </list>
   If the signature verifies, the target system has protection from the digital emblem. In all other cases, it does not.</t>
   </section>
   </section>

   <section title="IANA Considerations">
   </section>

   <section title="Security Considerations">
   </section>

   <section title="Contributors">
   </section>

   <section title="Acknowledgments">
   </section>
 </middle>

 <back>
   <references title="Normative References">
      <?rfc include="reference.RFC.1035" ?>
      <?rfc include="reference.RFC.2119" ?>
      <?rfc include="reference.RFC.4033" ?>
      <?rfc include="reference.RFC.4034" ?>
      <?rfc include="reference.RFC.4035" ?>
      <?rfc include="reference.RFC.6698" ?>
      <?rfc include="reference.RFC.7671" ?>
      <?rfc include="reference.RFC.8552" ?>
   </references>

   <references title="Informative References">
      <?rfc include="reference.RFC.7208" ?>
   </references>

 </back>
</rfc>
